{{- define "client.tmpl" -}}
// <auto-generated />
#nullable enable

namespace {{ .Namespace }};

using System;
using System.Net.Http;
using System.Text.Json;
using System.Threading;
using System.Threading.Tasks;
{{- if .UsesCollections }}
using System.Collections.Generic;
{{- end }}
using SumUp.Http;

public sealed partial class {{ .ClientName }}Client
{
    private readonly ApiClient _client;

    internal {{ .ClientName }}Client(ApiClient client)
    {
        _client = client;
    }
{{- range .Operations }}

    /// <summary>
    /// {{ .Summary }}
    /// </summary>
    {{- if .Description }}
    /// <remarks>{{ .Description }}</remarks>
    {{- end }}
    {{- range .Parameters }}
    /// <param name="{{ .Name }}">{{- if .Description }}{{ .Description }}{{ else }}Request parameter.{{ end }}</param>
    {{- end }}
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<{{ .ResponseType }}> {{ .MethodName }}({{ if .HasParameters }}{{- range $index, $param := .Parameters }}{{ if $index }}, {{ end }}{{ $param.Signature }}{{ end }}, {{ end }}CancellationToken cancellationToken = default)
    {
        {{- if .HasBuilder }}
        var request = _client.CreateRequest({{ .HttpMethodExpr }}, "{{ .Path }}", builder =>
        {
            {{- range .PathParams }}
            {{ .BuilderCall }}
            {{- end }}
            {{- range .QueryParams }}
            {{ .BuilderCall }}
            {{- end }}
            {{- range .HeaderParams }}
            {{ .BuilderCall }}
            {{- end }}
        });
        {{- else }}
        var request = _client.CreateRequest({{ .HttpMethodExpr }}, "{{ .Path }}");
        {{- end }}
        return _client.Send<{{ .ResponseType }}>(request, {{ if .HasRequestBody }}{{ .Body.ArgName }}{{ else }}null{{ end }}, {{ if .HasRequestBody }}"{{ .Body.ContentType }}"{{ else }}null{{ end }}, cancellationToken);
    }

    /// <summary>
    /// {{ .Summary }}
    /// </summary>
    {{- if .Description }}
    /// <remarks>{{ .Description }}</remarks>
    {{- end }}
    {{- range .Parameters }}
    /// <param name="{{ .Name }}">{{- if .Description }}{{ .Description }}{{ else }}Request parameter.{{ end }}</param>
    {{- end }}
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<{{ .ResponseType }}>> {{ .MethodName }}Async({{ if .HasParameters }}{{- range $index, $param := .Parameters }}{{ if $index }}, {{ end }}{{ $param.Signature }}{{ end }}, {{ end }}CancellationToken cancellationToken = default)
    {
        {{- if .HasBuilder }}
        var request = _client.CreateRequest({{ .HttpMethodExpr }}, "{{ .Path }}", builder =>
        {
            {{- range .PathParams }}
            {{ .BuilderCall }}
            {{- end }}
            {{- range .QueryParams }}
            {{ .BuilderCall }}
            {{- end }}
            {{- range .HeaderParams }}
            {{ .BuilderCall }}
            {{- end }}
        });
        {{- else }}
        var request = _client.CreateRequest({{ .HttpMethodExpr }}, "{{ .Path }}");
        {{- end }}
        return await _client.SendAsync<{{ .ResponseType }}>(request, {{ if .HasRequestBody }}{{ .Body.ArgName }}{{ else }}null{{ end }}, {{ if .HasRequestBody }}"{{ .Body.ContentType }}"{{ else }}null{{ end }}, cancellationToken).ConfigureAwait(false);
    }
{{- end }}
}
{{- end }}
