// <auto-generated />
#nullable enable

namespace SumUp;

using System;
using System.Net.Http;
using System.Text.Json;
using System.Threading;
using System.Threading.Tasks;
using System.Collections.Generic;
using SumUp.Http;

public sealed partial class CustomersClient
{
    private readonly ApiClient _client;

    internal CustomersClient(ApiClient client)
    {
        _client = client;
    }

    /// <summary>
    /// Create a customer
    /// </summary>
    /// <remarks>Creates a new saved customer resource which you can later manipulate and save payment instruments to.</remarks>
    /// <param name="body">Details of the customer.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<Customer> Create(Customer body, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Post, "/v0.1/customers");
        return _client.Send<Customer>(request, body, "application/json", cancellationToken);
    }

    /// <summary>
    /// Create a customer
    /// </summary>
    /// <remarks>Creates a new saved customer resource which you can later manipulate and save payment instruments to.</remarks>
    /// <param name="body">Details of the customer.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<Customer>> CreateAsync(Customer body, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Post, "/v0.1/customers");
        return await _client.SendAsync<Customer>(request, body, "application/json", cancellationToken).ConfigureAwait(false);
    }

    /// <summary>
    /// Deactivate a payment instrument
    /// </summary>
    /// <remarks>Deactivates an identified card payment instrument resource for a customer.</remarks>
    /// <param name="customerId">Unique ID of the saved customer resource.</param>
    /// <param name="token">Unique token identifying the card saved as a payment instrument resource.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<JsonDocument> DeactivatePaymentInstrument(string customerId, string token, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Delete, "/v0.1/customers/{customer_id}/payment-instruments/{token}", builder =>
        {
            builder.AddPath("customer_id", customerId);
            builder.AddPath("token", token);
        });
        return _client.Send<JsonDocument>(request, null, null, cancellationToken);
    }

    /// <summary>
    /// Deactivate a payment instrument
    /// </summary>
    /// <remarks>Deactivates an identified card payment instrument resource for a customer.</remarks>
    /// <param name="customerId">Unique ID of the saved customer resource.</param>
    /// <param name="token">Unique token identifying the card saved as a payment instrument resource.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<JsonDocument>> DeactivatePaymentInstrumentAsync(string customerId, string token, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Delete, "/v0.1/customers/{customer_id}/payment-instruments/{token}", builder =>
        {
            builder.AddPath("customer_id", customerId);
            builder.AddPath("token", token);
        });
        return await _client.SendAsync<JsonDocument>(request, null, null, cancellationToken).ConfigureAwait(false);
    }

    /// <summary>
    /// Retrieve a customer
    /// </summary>
    /// <remarks>Retrieves an identified saved customer resource through the unique `customer_id` parameter, generated upon customer creation.</remarks>
    /// <param name="customerId">Unique ID of the saved customer resource.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<Customer> Get(string customerId, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Get, "/v0.1/customers/{customer_id}", builder =>
        {
            builder.AddPath("customer_id", customerId);
        });
        return _client.Send<Customer>(request, null, null, cancellationToken);
    }

    /// <summary>
    /// Retrieve a customer
    /// </summary>
    /// <remarks>Retrieves an identified saved customer resource through the unique `customer_id` parameter, generated upon customer creation.</remarks>
    /// <param name="customerId">Unique ID of the saved customer resource.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<Customer>> GetAsync(string customerId, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Get, "/v0.1/customers/{customer_id}", builder =>
        {
            builder.AddPath("customer_id", customerId);
        });
        return await _client.SendAsync<Customer>(request, null, null, cancellationToken).ConfigureAwait(false);
    }

    /// <summary>
    /// List payment instruments
    /// </summary>
    /// <remarks>Lists all payment instrument resources that are saved for an identified customer.</remarks>
    /// <param name="customerId">Unique ID of the saved customer resource.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<IEnumerable<PaymentInstrumentResponse>> ListPaymentInstruments(string customerId, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Get, "/v0.1/customers/{customer_id}/payment-instruments", builder =>
        {
            builder.AddPath("customer_id", customerId);
        });
        return _client.Send<IEnumerable<PaymentInstrumentResponse>>(request, null, null, cancellationToken);
    }

    /// <summary>
    /// List payment instruments
    /// </summary>
    /// <remarks>Lists all payment instrument resources that are saved for an identified customer.</remarks>
    /// <param name="customerId">Unique ID of the saved customer resource.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<IEnumerable<PaymentInstrumentResponse>>> ListPaymentInstrumentsAsync(string customerId, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Get, "/v0.1/customers/{customer_id}/payment-instruments", builder =>
        {
            builder.AddPath("customer_id", customerId);
        });
        return await _client.SendAsync<IEnumerable<PaymentInstrumentResponse>>(request, null, null, cancellationToken).ConfigureAwait(false);
    }

    /// <summary>
    /// Update a customer
    /// </summary>
    /// <remarks>Updates an identified saved customer resource's personal details. The request only overwrites the parameters included in the request, all other parameters will remain with their initially assigned values.</remarks>
    /// <param name="customerId">Unique ID of the saved customer resource.</param>
    /// <param name="body">Request body payload.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<Customer> Update(string customerId, CustomersUpdateRequest body, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Put, "/v0.1/customers/{customer_id}", builder =>
        {
            builder.AddPath("customer_id", customerId);
        });
        return _client.Send<Customer>(request, body, "application/json", cancellationToken);
    }

    /// <summary>
    /// Update a customer
    /// </summary>
    /// <remarks>Updates an identified saved customer resource's personal details. The request only overwrites the parameters included in the request, all other parameters will remain with their initially assigned values.</remarks>
    /// <param name="customerId">Unique ID of the saved customer resource.</param>
    /// <param name="body">Request body payload.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<Customer>> UpdateAsync(string customerId, CustomersUpdateRequest body, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Put, "/v0.1/customers/{customer_id}", builder =>
        {
            builder.AddPath("customer_id", customerId);
        });
        return await _client.SendAsync<Customer>(request, body, "application/json", cancellationToken).ConfigureAwait(false);
    }
}