// <auto-generated />
#nullable enable

namespace SumUp;

using System;
using System.Net.Http;
using System.Text.Json;
using System.Threading;
using System.Threading.Tasks;
using System.Collections.Generic;
using SumUp.Http;

public sealed partial class CheckoutsClient
{
    private readonly ApiClient _client;

    internal CheckoutsClient(ApiClient client)
    {
        _client = client;
    }

    /// <summary>
    /// Create a checkout
    /// </summary>
    /// <remarks>Creates a new payment checkout resource. The unique `checkout_reference` created by this request, is used for further manipulation of the checkout. For 3DS checkouts, add the `redirect_url` parameter to your request body schema. Follow by processing a checkout to charge the provided payment instrument.</remarks>
    /// <param name="body">Request body payload.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<Checkout> Create(CheckoutCreateRequest body, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Post, "/v0.1/checkouts");
        return _client.Send<Checkout>(request, body, "application/json", cancellationToken, requestOptions);
    }

    /// <summary>
    /// Create a checkout
    /// </summary>
    /// <remarks>Creates a new payment checkout resource. The unique `checkout_reference` created by this request, is used for further manipulation of the checkout. For 3DS checkouts, add the `redirect_url` parameter to your request body schema. Follow by processing a checkout to charge the provided payment instrument.</remarks>
    /// <param name="body">Request body payload.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<Checkout>> CreateAsync(CheckoutCreateRequest body, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Post, "/v0.1/checkouts");
        return await _client.SendAsync<Checkout>(request, body, "application/json", cancellationToken, requestOptions).ConfigureAwait(false);
    }

    /// <summary>
    /// Deactivate a checkout
    /// </summary>
    /// <remarks>Deactivates an identified checkout resource. If the checkout has already been processed it can not be deactivated.</remarks>
    /// <param name="id">Unique ID of the checkout resource.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<Checkout> Deactivate(string id, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Delete, "/v0.1/checkouts/{id}", builder =>
        {
            builder.AddPath("id", id);
        });
        return _client.Send<Checkout>(request, null, null, cancellationToken, requestOptions);
    }

    /// <summary>
    /// Deactivate a checkout
    /// </summary>
    /// <remarks>Deactivates an identified checkout resource. If the checkout has already been processed it can not be deactivated.</remarks>
    /// <param name="id">Unique ID of the checkout resource.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<Checkout>> DeactivateAsync(string id, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Delete, "/v0.1/checkouts/{id}", builder =>
        {
            builder.AddPath("id", id);
        });
        return await _client.SendAsync<Checkout>(request, null, null, cancellationToken, requestOptions).ConfigureAwait(false);
    }

    /// <summary>
    /// Retrieve a checkout
    /// </summary>
    /// <remarks>Retrieves an identified checkout resource. Use this request after processing a checkout to confirm its status and inform the end user respectively.</remarks>
    /// <param name="id">Unique ID of the checkout resource.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<CheckoutSuccess> Get(string id, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Get, "/v0.1/checkouts/{id}", builder =>
        {
            builder.AddPath("id", id);
        });
        return _client.Send<CheckoutSuccess>(request, null, null, cancellationToken, requestOptions);
    }

    /// <summary>
    /// Retrieve a checkout
    /// </summary>
    /// <remarks>Retrieves an identified checkout resource. Use this request after processing a checkout to confirm its status and inform the end user respectively.</remarks>
    /// <param name="id">Unique ID of the checkout resource.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<CheckoutSuccess>> GetAsync(string id, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Get, "/v0.1/checkouts/{id}", builder =>
        {
            builder.AddPath("id", id);
        });
        return await _client.SendAsync<CheckoutSuccess>(request, null, null, cancellationToken, requestOptions).ConfigureAwait(false);
    }

    /// <summary>
    /// List checkouts
    /// </summary>
    /// <remarks>Lists created checkout resources according to the applied `checkout_reference`.</remarks>
    /// <param name="checkoutReference">Filters the list of checkout resources by the unique ID of the checkout.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<IEnumerable<CheckoutSuccess>> List(string? checkoutReference = null, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Get, "/v0.1/checkouts", builder =>
        {
            builder.AddQuery("checkout_reference", checkoutReference);
        });
        return _client.Send<IEnumerable<CheckoutSuccess>>(request, null, null, cancellationToken, requestOptions);
    }

    /// <summary>
    /// List checkouts
    /// </summary>
    /// <remarks>Lists created checkout resources according to the applied `checkout_reference`.</remarks>
    /// <param name="checkoutReference">Filters the list of checkout resources by the unique ID of the checkout.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<IEnumerable<CheckoutSuccess>>> ListAsync(string? checkoutReference = null, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Get, "/v0.1/checkouts", builder =>
        {
            builder.AddQuery("checkout_reference", checkoutReference);
        });
        return await _client.SendAsync<IEnumerable<CheckoutSuccess>>(request, null, null, cancellationToken, requestOptions).ConfigureAwait(false);
    }

    /// <summary>
    /// Get available payment methods
    /// </summary>
    /// <remarks>Get payment methods available for the given merchant to use with a checkout.</remarks>
    /// <param name="merchantCode">The SumUp merchant code.</param>
    /// <param name="amount">The amount for which the payment methods should be eligible, in major units. Note that currency must also be provided when filtering by amount.</param>
    /// <param name="currency">The currency for which the payment methods should be eligible.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<CheckoutsListAvailablePaymentMethodsResponse> ListAvailablePaymentMethods(string merchantCode, decimal? amount = null, string? currency = null, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Get, "/v0.1/merchants/{merchant_code}/payment-methods", builder =>
        {
            builder.AddPath("merchant_code", merchantCode);
            builder.AddQuery("amount", amount);
            builder.AddQuery("currency", currency);
        });
        return _client.Send<CheckoutsListAvailablePaymentMethodsResponse>(request, null, null, cancellationToken, requestOptions);
    }

    /// <summary>
    /// Get available payment methods
    /// </summary>
    /// <remarks>Get payment methods available for the given merchant to use with a checkout.</remarks>
    /// <param name="merchantCode">The SumUp merchant code.</param>
    /// <param name="amount">The amount for which the payment methods should be eligible, in major units. Note that currency must also be provided when filtering by amount.</param>
    /// <param name="currency">The currency for which the payment methods should be eligible.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<CheckoutsListAvailablePaymentMethodsResponse>> ListAvailablePaymentMethodsAsync(string merchantCode, decimal? amount = null, string? currency = null, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Get, "/v0.1/merchants/{merchant_code}/payment-methods", builder =>
        {
            builder.AddPath("merchant_code", merchantCode);
            builder.AddQuery("amount", amount);
            builder.AddQuery("currency", currency);
        });
        return await _client.SendAsync<CheckoutsListAvailablePaymentMethodsResponse>(request, null, null, cancellationToken, requestOptions).ConfigureAwait(false);
    }

    /// <summary>
    /// Process a checkout
    /// </summary>
    /// <remarks>Processing a checkout will attempt to charge the provided payment instrument for the amount of the specified checkout resource initiated in the `Create a checkout` endpoint. Follow this request with `Retrieve a checkout` to confirm its status.</remarks>
    /// <param name="id">Unique ID of the checkout resource.</param>
    /// <param name="body">Details of the payment instrument for processing the checkout.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public ApiResponse<CheckoutSuccess> Process(string id, ProcessCheckout body, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Put, "/v0.1/checkouts/{id}", builder =>
        {
            builder.AddPath("id", id);
        });
        return _client.Send<CheckoutSuccess>(request, body, "application/json", cancellationToken, requestOptions);
    }

    /// <summary>
    /// Process a checkout
    /// </summary>
    /// <remarks>Processing a checkout will attempt to charge the provided payment instrument for the amount of the specified checkout resource initiated in the `Create a checkout` endpoint. Follow this request with `Retrieve a checkout` to confirm its status.</remarks>
    /// <param name="id">Unique ID of the checkout resource.</param>
    /// <param name="body">Details of the payment instrument for processing the checkout.</param>
    /// <param name="requestOptions">Optional per-request overrides.</param>
    /// <param name="cancellationToken">Token used to cancel the request.</param>
    public async Task<ApiResponse<CheckoutSuccess>> ProcessAsync(string id, ProcessCheckout body, RequestOptions? requestOptions = null, CancellationToken cancellationToken = default)
    {
        var request = _client.CreateRequest(HttpMethod.Put, "/v0.1/checkouts/{id}", builder =>
        {
            builder.AddPath("id", id);
        });
        return await _client.SendAsync<CheckoutSuccess>(request, body, "application/json", cancellationToken, requestOptions).ConfigureAwait(false);
    }
}